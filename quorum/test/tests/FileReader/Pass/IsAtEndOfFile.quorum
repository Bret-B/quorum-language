use Libraries.System.File
use Libraries.System.FileReader
use Libraries.Containers.Blueprints.Indexed

class Main
    action Main
        // Open empty file, and non-empty files, check IsAtEndOfFile in various spots.
        // Read contents of single line file, then multi-line file.
        File f
        f:SetRelativePath("test/tests/FileReader/Resources/empty")

        FileReader r
        r:OpenForRead(f)
        boolean emptyAtEOF = r:IsAtEndOfFile()
        r:Close()
        
        f:SetRelativePath("test/tests/FileReader/Resources/singleLine")
        r:OpenForRead(f)
        boolean singleStartAtEOF = r:IsAtEndOfFile() // should be false.
        r:Read(2)
        boolean singleAfterAtEOF = r:IsAtEndOfFile() // should still be false.
        r:Read()
        boolean singleLastAtEOF = r:IsAtEndOfFile() // should now be true.
        r:Close()

        // open same file, read a line, should be at eof.
        f:SetRelativePath("test/tests/FileReader/Resources/singleLine")
        r:OpenForRead(f)
        r:ReadLine()
        boolean singleAfterReadLineEOF = r:IsAtEndOfFile() // should be true
        r:Close()

        print emptyAtEOF // true
        print singleStartAtEOF // false
        print singleAfterAtEOF // false
        print singleLastAtEOF // true
        print singleAfterReadLineEOF // true
    end
end