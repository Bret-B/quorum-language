package Libraries.Interface.Controls.Charts

use Libraries.Containers.Array
use Libraries.Game.Graphics.Color
use Libraries.Compute.Vector
use Libraries.Game.Graphics.Drawable
use Libraries.Interface.Controls.Icon

/*
The Plot class is a data structure that stores information for each 
indiviual plot in a box plot or violin plot. Plot contains an array of data and a color element
that is used for accessibility and keeping track of to which series the plot belongs.

Attribute: Example

use Libraries.Interface.Controls.Charts.Plot
class Main
   action Main
      //make plot
      plot plot
      //add value
      plot:Add(30)
      //get value
      number x = plot:Get(0)
   end
end
*/

class Plot is Drawable
    Vector data
    Array <number> info
    Array <number> outliers
    Array <Drawable> items
    Series series
    Icon icon
    Color plotcolor
    text name = ""
    private number minOutlierValue = 0
    private number maxOutlierValue = 0

    /* Indices info of individual plot values (info)
        0: MEDIAN
        1: Q1 LOWER QUARTILE
        2: Q3 UPPER QUARTILE
        3: MINIMUM
        4: MAXIMUM
    */

     /* Indices for plotting items of individual plot (items)
        0: PLOT AREA 
        1: MINIMUM LINE
        2: LOWER WHISKER
        3: INTERQUARTILE RANGE
        4: RIGHT BORDER OF IQR
        5: LEFT BORDER OF IQR
        6: Q1 LINE
        7: MEDIAN LINE
        8: Q3 LINE
        9: UPPER WHISKER    
        10: MAXIMUM LINE 
        11+: OUTLIERS
    */

    action SetName(text name)
        me:name = name
    end
    
    action GetName() returns text
        return name
    end

    action SetColor(Color color)
        plotcolor = color
    end

    action GetColor() returns Color
        return plotcolor
    end

    action GetIcon() returns Icon
        return icon
    end

    action SetIcon(Icon icon)
        me:icon = icon
    end

    action SetData(Vector vector)
        data = vector:Copy()
        if data:GetSize() > 0
            minOutlierValue = data:Get(0)
            maxOutlierValue = data:Get(data:GetSize()-1)
        end
    end
    
    action GetData() returns Vector
        return data
    end

    // Fill in plotting information and outliers.
    action SetInfo(Array<number> array)
        integer i = 0
        repeat while i < array:GetSize()
            if i < 5
                info:Add(array:Get(i))
            else
                outliers:Add(array:Get(i))
            end
            i = i + 1
        end
    end
    
    action GetInfo() returns Array<number>
        return info
    end
    
    action GetOutliers() returns Array<number>
        return outliers
    end
    
    action AddInfo(number value)
        info:Add(value)
    end

    action GetInfoAt(integer index) returns number
        return info:Get(index)
    end

    action GetInfoSize() returns integer
        return info:GetSize()
    end

    action AddItem(Drawable item)
        items:Add(item)
    end
    
    action GetPlotItems() returns Array<Drawable> 
        return items
    end

    action GetSeries returns Series
        return series
    end

    action SetSeries(Series series)
        me:series = series
    end

    action GetMinOutlierValue returns number
        return minOutlierValue
    end

    action GetMaxOutlierValue returns number
        return maxOutlierValue
    end
end