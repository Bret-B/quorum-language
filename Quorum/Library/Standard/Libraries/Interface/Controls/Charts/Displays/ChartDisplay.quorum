package Libraries.Interface.Controls.Charts
use Libraries.Game.Game
use Libraries.Interface.Layouts.ManualLayout
use Libraries.Game.DesktopConfiguration
use Libraries.Game.WebConfiguration
use Libraries.Game.Layer2D
use Libraries.Game.Layer3D

/*
    This class is used as a default display region for charts. It allows basic
    charts to be shown on screen, and accessible, without extending the game class.

    Attribute: Author Andreas Stefik
*/
class ChartDisplay is Game
    boolean exitOnStart = false
    integer frame = 0

    on create
        DesktopConfiguration desktop = GetDesktopConfiguration()
        desktop:targetFramesPerSecond = 10
        WebConfiguration web = GetWebConfiguration()
        web:framesPerSecondLimit = 10
    end

    Chart chart = undefined
    action GetChart returns Chart
        return chart
    end

    action SetChart(Chart chart)
        me:chart = chart
    end

    action CreateGame
        ManualLayout layout
        SetLayout(layout)

        Layer2D layer = GetCurrentLayer2D()
        layer:EnablePhysics(false)

        Layer3D layer3D = GetCurrentLayer3D()
        layer3D:EnablePhysics(false)

        chart:SetPercentageWidth(1)
        chart:SetPercentageHeight(1)

        Add(chart)
        chart:Focus()
    end

    action Update(number seconds)
        if frame >= 1 and exitOnStart
            Exit()
        end

        frame = frame + 1
    end

    action GetExitOnStart returns boolean
        return exitOnStart
    end

    action SetExitOnStart(boolean exitOnStart)
        me:exitOnStart = exitOnStart
    end
end