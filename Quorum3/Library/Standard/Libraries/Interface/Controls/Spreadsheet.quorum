package Libraries.Interface.Controls
use Libraries.Containers.Array
use Libraries.Interface.Layouts.FlowLayout
use Libraries.Interface.Layouts.LayoutProperties
use Libraries.Interface.Selections.SpreadsheetSelection


class Spreadsheet is Control
    Array<Column> columns
    SpreadsheetSelection selection
    
    on create
        FlowLayout layout
        SetLayout(layout)

        LayoutProperties properties = GetDefaultLayoutProperties()
        properties:SetHorizontalLayoutMode(properties:FIT_CONTENTS)
        properties:SetVerticalLayoutMode(properties:FIT_CONTENTS)

        SetInputGroup("Spreadsheet")

        SetFocusable(true)
        selection:Initialize(me)
        SetAccessibilityCode(parent:Item:TABLE)
        SetName("Table")
    end

    action Add(Column column)
        columns:Add(column)

        parent:Item2D:Add(column)
    end

    action Add(integer position, Column column)
        columns:Add(position, column)

        parent:Item2D:Add(column)
    end

    action GetColumn(integer i) returns Column
        return columns:Get(i)
    end

    action RemoveColumn(Column column)
        columns:Remove(column)
        parent:Item2D:Remove(column)
    end

    action RemoveColumnAt(integer column)
        Column c = columns:RemoveAt(column)
        parent:Item2D:Remove(c)
    end

    action GetColumnsSize returns integer
        return columns:GetSize()
    end

    action GetSelection returns SpreadsheetSelection
        return selection
    end

    action IsColumnsEmpty returns boolean
        return columns:IsEmpty()
    end

    action Empty 
        columns:Empty()
        parent:Item2D:Empty()
    end

    /*
        This action selects a single cell in the spreadsheet. In this case,
        a single cell.
    */
    action Select(Cell cell)

    end

    action MoveSelectionUp

    end

    action MoveSelectionDown

    end

    action MoveSelectionLeft

    end

    action MoveSelectionRight

    end
end